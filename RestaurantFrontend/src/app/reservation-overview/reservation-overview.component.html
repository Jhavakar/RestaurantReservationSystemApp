<div class="container my-5">
  <header class="mb-4">
    <h1 class="display-4">Welcome back!</h1>
    <p>Your reservation details are below:</p>
  </header>

  <div *ngFor="let reservation of reservations" class="card mb-4">
    <div class="card-body">
      <h2 class="card-title">Reservation Summary</h2>
      <ul *ngIf="reservation.reservationId !== undefined && !editingStates[reservation.reservationId]" class="list-group">
        <li class="list-group-item"><strong>First Name:</strong> {{ reservation.user.firstName }}</li>
        <li class="list-group-item"><strong>Last Name:</strong> {{ reservation.user.lastName }}</li>
        <li class="list-group-item"><strong>Email Address:</strong> {{ reservation.user.emailAddress }}</li>
        <li class="list-group-item"><strong>Phone Number (Optional):</strong> {{ reservation.user.phoneNumber }}</li>
        <li class="list-group-item"><strong>Date and Time:</strong> {{ reservation.reservationDateTime | date: 'short' }}</li>
        <li class="list-group-item"><strong>Number of Guests:</strong> {{ reservation.numberOfGuests }}</li>
        <li class="list-group-item"><strong>Special Requests:</strong> {{ reservation.specialRequests ? reservation.specialRequests : 'No special requests' }}</li>

      </ul>

      <form *ngIf="reservation.reservationId !== undefined && editingStates[reservation.reservationId]" [formGroup]="editForms[reservation.reservationId]" (ngSubmit)="updateReservation(reservation.reservationId)">
        <div class="form-group">
          <label>First Name:</label>
          <input type="text" class="form-control" formControlName="firstName" readonly>
        </div>
        <div class="form-group">
          <label>Last Name:</label>
          <input type="text" class="form-control" formControlName="lastName" readonly>
        </div>
        <div class="form-group">
          <label>Email Address:</label>
          <input type="email" class="form-control" formControlName="emailAddress">
        </div>
        <div class="form-group">
          <label>Phone Number (Optional):</label>
          <input type="text" class="form-control" formControlName="phoneNumber" placeholder="Enter phone number.">
        </div>
        <div class="form-group">
          <label>Date:</label>
          <input type="date" class="form-control" formControlName="reservationDate">
        </div>
        <div>
          <label for="reservationTime">Reservation Time:</label>
          <select formControlName="reservationTime">
            <option *ngFor="let timeSlot of timeSlots" [value]="timeSlot" [disabled]="!isTimeSlotAvailable(timeSlot)">
              {{ timeSlot }}
            </option>
          </select>
        </div>
        <div class="form-group">
          <label>Number of Guests:</label>
          <input type="number" class="form-control" formControlName="numberOfGuests">
        </div>
        <div class="form-group">
          <label for="specialRequests">Special Requests:</label>
          <textarea type="text" class="form-control" formControlName="specialRequests" placeholder="Enter any dietary restrictions, special occasions, or any other preferences here."></textarea>
        </div>
        <button type="submit" class="btn btn-success">Update Reservation</button>
        <button type="button" class="btn btn-secondary" (click)="cancelEdit(reservation.reservationId)">Cancel</button>
      </form>
      
      <button *ngIf="reservation.reservationId !== undefined && !editingStates[reservation.reservationId]" class="btn btn-primary" (click)="editReservation(reservation.reservationId)">Edit Reservation</button>
      <button *ngIf="reservation.reservationId !== undefined && !editingStates[reservation.reservationId]" class="btn btn-danger" (click)="deleteReservation(reservation.reservationId)">Cancel Reservation</button>      
    </div>
  </div>
</div>

<app-reservation-success-modal *ngIf="showModal" (closeModal)="closeModal()"></app-reservation-success-modal>
